function ChannelMap = Pitt_chan_mapper_CRS02b(file_path)
if nargin < 1
    [file,path] = uigetfile('*.txt');
    file_path = fullfile(path, file);
end

% load mapfile
tbl = readtable(file_path, 'Delimiter', '\t', 'HeaderLines', 14, 'ReadVariableNames', 1, 'ReadRowNames', 0);
tbl = sortrows(tbl,[3,4]);
ChannelMap.full_table = tbl;

ChannelMap.ArrayNames2 = {'Anterior Motor', 'Anterior Sensory', 'Posterior Motor', 'Posterior Sensory'};
ChannelMap.ArrayNames = {'Lateral Motor', 'Lateral Sensory', 'Medial Motor', 'Medial Sensory'};
ChannelMap.ChanIndices = {[1:64, 97:128], 65:96, [129:192, 225:256], 193:224};
ChannelMap.ArrayColors = [66,146,198; 251,106,74; 8,69,148; 203,24,29]/256;


ChannelMap.GridLoc = {};
for ar = 1:4
    row = 10 - tbl.row(ChannelMap.ChanIndices{ar});
    col = tbl.col(ChannelMap.ChanIndices{ar});
    col = col - min(col) + 1;
    N_row = length(unique(row));
    N_col = length(unique(col));
    lin_loc_indices = sub2ind([N_row N_col], row, col);
    ChannelMap.GridLoc{ar} = nan(N_row, N_col);
    ChannelMap.GridLoc{ar}(lin_loc_indices) = ChannelMap.ChanIndices{ar};
end

ChannelMap.MotorSubplotMapping = [1:10; 11:20; 21:30; 31:40; 41:50; 51:60; 61:70; 71:80; 81:90; 91:100];
ChannelMap.SensorySubplotMapping = [1:6; 7:12; 13:18; 19:24; 25:30; 31:36; 37:42; 43:48; 49:54; 55:60];
ChannelMap.ChanToElectrode = {[1:64, 97:128], [1:32], [129:192, 225:256], [33:64]};

% For CRS02b
ChannelMap.GridLoc{1} = [ ... % wire bundle to right, viewing from pad side (electrodes down)
    NaN NaN 42 58 3 13 27 97 NaN NaN; ...
    NaN 34 44 57 4 19 29 98 107 NaN; ...
    33 36 51 62 7 10 31 99 108 117; ...
    35 38 53 60 5 12 18 100 109 119; ...
    37 40 50 59 6 23 22 101 110 121; ...
    39 43 46 64 9 25 24 102 111 123; ...
    41 47 56 61 17 21 26 103 113 125; ...
    45 49 55 63 15 14 28 104 112 127; ...
    NaN 48 54 2 8 16 30 105 115 NaN; ...
    NaN NaN 52 1 11 20 32 106 NaN NaN ]; 

ChannelMap.GridLoc{3} = [ ... % wire bundle to right, viewing from pad side (electrodes down)
    NaN NaN 42 58 3 13 27 97 NaN NaN; ...
    NaN 34 44 57 4 19 29 98 107 NaN; ...
    33 36 51 62 7 10 31 99 108 117; ...
    35 38 53 60 5 12 18 100 109 119; ...
    37 40 50 59 6 23 22 101 110 121; ...
    39 43 46 64 9 25 24 102 111 123; ...
    41 47 56 61 17 21 26 103 113 125; ...
    45 49 55 63 15 14 28 104 112 127; ...
    NaN 48 54 2 8 16 30 105 115 NaN; ...
    NaN NaN 52 1 11 20 32 106 NaN NaN ] + 128; 

ChannelMap.GridLoc{2}  = [ ... % wire bundle to right, viewing from pad side (electrodes down)
    65 NaN 72 NaN 85 91; ...
    NaN 77 NaN 81 NaN 92; ...
    67 NaN 74 NaN 87 NaN; ...
    NaN NaN NaN 82 NaN 94; ...
    69  79 76 NaN 88 NaN; ...
    NaN 66 NaN 84 NaN 93; ...
    71 NaN 78 NaN 89 NaN; ...
    NaN 68 NaN 83 NaN 96; ...
    73 NaN 80 NaN 90 NaN; ...
    75 70 NaN 86 NaN 95; ...
    ];

ChannelMap.GridLoc{4}  = [ ... % wire bundle to right, viewing from pad side (electrodes down).
    65 NaN 72 NaN 85 91; ...
    NaN 77 NaN 81 NaN 92; ...
    67 NaN 74 NaN 87 NaN; ...
    NaN 79 NaN 82 NaN 94; ...
    69 NaN 76 NaN 88 NaN; ...
    NaN 66 NaN 84 NaN 93; ...
    71 NaN 78 NaN 89 NaN; ...
    NaN 68 NaN 83 NaN 96; ...
    73 NaN 80 NaN 90 NaN; ...
    75 70 NaN 86 NaN 95; ...
    ] + 128;

ChannelMap.MotorSubplotMapping = [1:10; 11:20; 21:30; 31:40; 41:50; 51:60; 61:70; 71:80; 81:90; 91:100];
ChannelMap.SensorySubplotMapping = [1:6; 7:12; 13:18; 19:24; 25:30; 31:36; 37:42; 43:48; 49:54; 55:60];
ChannelMap.ChanToElectrode = {[1:64, 97:128], [1:32], [129:192, 225:256], [33:64]};

end